<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../../bower_components/wired-card/wired-card.html">
<link rel="import" href="../../bower_components/wired-button/wired-button.html">
<link rel="import" href="../../bower_components/wired-input/wired-input.html">


<dom-module id="create-room">
  <template>

    <style>
      .create-room {
        padding: 5px 75px 25px 75px;
        text-align: center;
      }
    </style>

    <wired-card class="create-room">
      <h3>Create Room</h3>
      <wired-input id="roomName" placeholder="Room name"></wired-input>
      <wired-button text="Create" on-click="createRoom"></wired-button>
    </wired-card>

    <firebase-query id="createRoomQuery" path="/rooms" />

  </template>

  <script>
    class CreateRoom extends Polymer.Element {
      static get is() { return 'create-room'; }

      createRoom() {
        this.$.createRoomQuery.ref
          .push({name: this.$.roomName.value})
          .then(this.dispatchJoinRoomEvent);
      }

      dispatchJoinRoomEvent(room) {
        document.dispatchEvent(new CustomEvent('join-room', {detail: {roomKey: room.key}}));
      }

    }

    window.customElements.define(CreateRoom.is, CreateRoom);
  </script>
</dom-module>